

CREATE SCHEMA dbTeamMessi;

USE dbTeamMessi;


CREATE TABLE usuarios (
	id INT UNSIGNED PRIMARY KEY NOT NULL AUTO_INCREMENT,
	email VARCHAR(255) NOT NULL,
    username VARCHAR(255) NOT NULL,
    password VARCHAR(255) NOT NULL,
    date DATE NOT NULL,
	image VARCHAR(255) NOT NULL,
    createdAt DATETIME not null,
    updatedAt DATETIME
);

CREATE TABLE productos (
	id INT UNSIGNED PRIMARY KEY NOT NULL UNIQUE AUTO_INCREMENT,
    image VARCHAR(255) NOT NULL,
    titulo VARCHAR(255) NOT NULL,
    descripcion VARCHAR(255) NOT NULL,
    fecha INT(4) UNSIGNED NOT NULL,
    color VARCHAR(255) NOT NULL,
    createdAt DATETIME not null,
    updatedAt DATETIME,
    
    FkUsuarioId INT UNSIGNED,
    FOREIGN KEY (FkUsuarioId) REFERENCES usuarios(id)
);

CREATE TABLE comentarios (
	id INT UNSIGNED PRIMARY KEY NOT NULL UNIQUE AUTO_INCREMENT,
    text varchar(255) NOT NULL,
    FkProductosId INT UNSIGNED NOT NULL,
    FkUsuarioId INT UNSIGNED NOT NULL,
    createdAt DATETIME not null,
    updatedAt DATETIME,

    FOREIGN KEY (FkProductosId) REFERENCES productos(id),
    FOREIGN KEY (FkUsuarioId) REFERENCES usuarios(id)
);

CREATE TABLE seguidores (
	id INT UNSIGNED PRIMARY KEY NOT NULL UNIQUE AUTO_INCREMENT,
    FkUsuarioId INT UNSIGNED NOT NULL,
    FkSeguidorId INT UNSIGNED NOT NULL,
    
    FOREIGN KEY (FkUsuarioId) REFERENCES usuarios(id),
	FOREIGN KEY (FkSeguidorId) REFERENCES usuarios(id)
);

INSERT INTO usuarios (id,email,username,password) VALUES ('2','fvarela@udesa.edu.ar','thomasmendez','pipe123'),('3','vareltta@udesa.edu.ar','bautisp','thom123'),('4','bautista@gmail.com','enzocopetti','bau123');


INSERT INTO productos (id,FkUsuarioId,titulo,descripcion,fecha,image)
VALUES( '1','3','Air Jordan 1','El primer modelo de la colección y seguramente el más popular. Llevaron el sobrenombre de «Notorious» y convirtieron a Michael Jordan en Rookie of the Year','22/05/2021',''),
('2','3','Air Jordan 35 DNA','Un homenaje a los colores clásicos de las Jordan 5, de ahí el sobrenombre de DNA','24/7/2020',''),
('3','4','Air Jordan XXXI','Son un reboot de las Air Jordan 1, una reinterpretación del primer modelo','22/1/2022',''),
('4','2','Yeezy Boost 350','Es un modelo ultramoderno que conserva los elementos que hacen de esta zapatilla una de las más populares del momento, y viene acompañada con colores contrastados y atractivos, que generalmente suelen ser muy exclusivos','23/3/2022',''),
('5','4','Yeezy Boost 700','es un modelo inspirado en los tenis para correr con una suela gruesa. También tienen una combinación de materiales en la parte superior, lengüeta y cuello acolchados, amortiguación Boost y una suela de goma','12/4/2020',''),
('6','2','Nike Air Force Paradise','Las Air Force de toda la vida pero diseñadas por Nike y G-Dragon de la banda Big Bang','5/12/2020',''),
('7','4','Jordan Superfly','Estas zapatillas cuentan con la última revolución en amortiguación de baloncesto: espuma Nike React ultrarreactiva diseñada para jugar mejor y durante más tiempo','3/12/2020',''),
('8','2','Nike Air Huarache','Confeccionado para obtener ultra comodidad en cada pisada, con entresuela de espuma suave brindando ligereza y capellada de malla combinado con sintético','15/10/2021',''),
('9','4','Adiddas Ozweego','Las zapatillas Ozweego se inspiran en los 90 para crear un estilo innovador. Estas zapatillas reinventan la OZWEEGO 3 de 1988 y la adaptan al presente. El resultado es un diseño ligero y cómodo equipado con la tecnología adiPRENE para ofrecer la máxima comodidad','17/11/2021',''),
('10','3','Nike Mid Blazer Vintage 77','Nike Blazer Mid 77 SE toma el estilo clásico de Nike Básquetbol. Sus diseños exquisitos de gamuza, el diseño Swoosh retro y el cuello acolchado lo convierten en un calzado básico moderno','2/7/2021','');

INSERT INTO comentarios (text,FkProductosId,FkUsuarioId)
VALUES('altaaaas','1','2'),
('precio?','2','3'),
('mmm normalitas','4','3'),
('queee locura de zapas','6','3'),
('las mejores zapatillas de la historia','8','4'),
('se vuelan amigo','10','2'),
('mis favoritas lejos','7','2'),
('son hermosas','2','4'),
('uffff locura','1','3'),
('feisimas','2','2');

INSERT INTO seguidores (id,FkUsuarioId,FkSeguidorId)
VALUES('1','2','3'),
('2','2','4'),
('3','3','2'),
('4','3','4'),
('5','2','3');


ALTER TABLE `dbteammessi`.`productos` 
DROP FOREIGN KEY `productos_ibfk_1`;
ALTER TABLE `dbteammessi`.`comentarios` 
DROP FOREIGN KEY `comentarios_ibfk_1`;
ALTER TABLE `dbteammessi`.`comentarios` 
DROP FOREIGN KEY `comentarios_ibfk_2`;
ALTER TABLE `dbteammessi`.`seguidores` 
DROP FOREIGN KEY `seguidores_ibfk_1`;
ALTER TABLE `dbteammessi`.`seguidores` 
DROP FOREIGN KEY `seguidores_ibfk_2`;


ALTER TABLE `dbteammessi`.`productos` 
ADD CONSTRAINT `FkUsuarioId`
  FOREIGN KEY (`FkUsuarioId`)
  REFERENCES `dbteammessi`.`productos` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;


ALTER TABLE `dbteammessi`.`comentarios` 
ADD CONSTRAINT `FkProductosId`
  FOREIGN KEY (`FkProductosId`)
  REFERENCES `dbteammessi`.`productos` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;


ALTER TABLE `dbteammessi`.`comentarios` 
ADD CONSTRAINT `FkProductosUsuariosId`
  FOREIGN KEY (`FkUsuarioId`)
  REFERENCES `dbteammessi`.`usuarios` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;



ALTER TABLE `dbteammessi`.`seguidores` 
ADD CONSTRAINT `FkUsuarioSeguidorId`
  FOREIGN KEY (`FkSeguidorId`)
  REFERENCES `dbteammessi`.`usuarios` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION,
ADD CONSTRAINT `FkUsuarioSeguidoId`
  FOREIGN KEY (`FkUsuarioId`)
  REFERENCES `dbteammessi`.`usuarios` (`id`)
  ON DELETE NO ACTION
  ON UPDATE NO ACTION;





